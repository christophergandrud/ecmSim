ecmSim
==============

[![Build Status](https://travis-ci.org/christophergandrud/ecmSim.svg?branch=master)](https://travis-ci.org/christophergandrud/ecmSim)

Early stage development version of a *possible* R package for simulating 
quantities of interest from Error Correction Models (ECM).

Use the `ecm_builder` function to simulated the quantities of interest and the
`ecm_plot` function (NOT COMPLETED to plot the results.

# Example

Imagine we have a two time series `dv` and `iv`. We want to estimate the 
relationship between these two series using an error correction model. 

Our estimation model could look like this (assuming we have already created
the change and lag variables and they are each in their own vectors or equal
length): 

```{r include=FALSE}
# Simulated data to estimate the model from
iv <- rnorm(10)
lag_iv <- c(NA, iv[-length(iv)])
d_iv <-  iv - lag_iv

b0 = 2
b1 = -0.2
b2 = 1.1
b3 = 2.2
starting_d_dv <- -4.1
eps <- rnorm(iv, sd = 0.2)

dv <- vector()
d_dv <- vector()
lag_dv <- vector()
for (i in 2:length(lag_iv)) {
    if (i == 2) {
        dv_start <- b0 + b2*lag_iv[i] + b3*d_iv[i] + eps[i]
                          lag_dv[3] <- dv_start + starting_d_dv
    }
    else if (i == 3) {
        d_dv[i] <- b0 + b1*lag_dv[i] + b2*lag_iv[i] + b3*d_iv[i] + eps[i]
    }
    else if (i > 3) {
        lag_dv[i] <- lag_dv[i-1] + d_dv[i-1]
        d_dv[i] <- b0 + b1*lag_dv[i] + b2*lag_iv[i] + b3*d_iv[i] + eps[i]
    }
}

```

```{r}
# Estimate error correction model
m1 <- lm(d_dv ~ lag_dv + lag_iv + d_iv)
```

We then create a data frame of fitted values for the baseline scenario to 
simulate.

```{r}
baseline_scen <- data.frame(lag_dv = mean(lag_dv, na.rm = TRUE),
                            lag_iv = mean(lag_iv, na.rm = TRUE))
```

We also specify the "shock" to `iv`, the effects of which we want to compare to
the baseline. 

```{r}
iv_shock <- sd(d_iv, na.rm = TRUE)
```

We now have all of the information we need to simulate the effects estimated in 
the ECM over 20 periods:

```{r}
m1_sims <- ecm_builder(obj = m1, lag_iv = 'lag_iv', d_iv = 'd_iv',
                       iv_shock = sd(d_iv, na.rm = TRUE),
                       baseline_df = baseline_scen, t_extent = 20)

# Show a sample of the simmulation output
head(m1_sims)
```